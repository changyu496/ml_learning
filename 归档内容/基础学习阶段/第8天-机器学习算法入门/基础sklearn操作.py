"""
åŸºç¡€sklearnæ“ä½œ - æ–­ç½‘æŒ‘æˆ˜ï¼ğŸ”¥
ç›®æ ‡ï¼šä¸æŸ¥èµ„æ–™å®ŒæˆsklearnåŸºæœ¬æ“ä½œ
æ—¶é—´ï¼š20åˆ†é’Ÿ
"""

import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score
import matplotlib.pyplot as plt

print("ğŸ”¥ åŸºç¡€sklearnæ“ä½œæŒ‘æˆ˜ - æ–­ç½‘ç»ƒä¹ ")
print("="*50)
print("âš ï¸  é‡è¦ï¼šå°½é‡ä¸æŸ¥èµ„æ–™ï¼Œå…ˆå°è¯•è‡ªå·±å†™ï¼")
print("ğŸ’¡ æç¤ºï¼šå¦‚æœå¡ä½äº†ï¼Œå…ˆæ€è€ƒ5åˆ†é’Ÿå†çœ‹ä¸‹é¢çš„æç¤º")

# ===== ç¬¬1å…³ï¼šåˆ›å»ºæ•°æ®é›† =====
print("\nğŸ¯ ç¬¬1å…³ï¼šåˆ›å»ºæ•°æ®é›†")
print("ä»»åŠ¡ï¼šåˆ›å»ºä¸€ä¸ªç®€å•çš„çº¿æ€§å…³ç³»æ•°æ®")

# åˆ›å»ºæ•°æ®
np.random.seed(42)
X = np.random.randn(100, 1) * 10
y = 2 * X.ravel() + 3 + np.random.randn(100) * 5

print(f"æ•°æ®å½¢çŠ¶: X={X.shape}, y={y.shape}")
print(f"å‰5ä¸ªæ ·æœ¬:\nX={X[:5].ravel()}\ny={y[:5]}")

# ä»»åŠ¡1.1ï¼šæ•°æ®åˆ†å‰²
print("\nğŸ“ ä»»åŠ¡1.1ï¼šå°†æ•°æ®åˆ†å‰²ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†")
print("è¦æ±‚ï¼š70%è®­ç»ƒï¼Œ30%æµ‹è¯•ï¼ŒéšæœºçŠ¶æ€=42")
print("ä½ çš„ä»£ç ï¼š")
# åœ¨è¿™é‡Œå†™ä»£ç ï¼š
# X_train, X_test, y_train, y_test = 

# ä»»åŠ¡1.2ï¼šæ£€æŸ¥åˆ†å‰²ç»“æœ
print("\nğŸ“ ä»»åŠ¡1.2ï¼šæ£€æŸ¥åˆ†å‰²ç»“æœ")
print("ä½ çš„ä»£ç ï¼š")
# åœ¨è¿™é‡Œå†™ä»£ç ï¼š
# print(f"è®­ç»ƒé›†å¤§å°: {X_train.shape[0]}")
# print(f"æµ‹è¯•é›†å¤§å°: {X_test.shape[0]}")

# ===== ç¬¬2å…³ï¼šæ¨¡å‹è®­ç»ƒ =====
print("\nğŸ¯ ç¬¬2å…³ï¼šæ¨¡å‹è®­ç»ƒ")

# ä»»åŠ¡2.1ï¼šåˆ›å»ºçº¿æ€§å›å½’æ¨¡å‹
print("\nğŸ“ ä»»åŠ¡2.1ï¼šåˆ›å»ºçº¿æ€§å›å½’æ¨¡å‹")
print("ä½ çš„ä»£ç ï¼š")
# åœ¨è¿™é‡Œå†™ä»£ç ï¼š
# model = 

# ä»»åŠ¡2.2ï¼šè®­ç»ƒæ¨¡å‹
print("\nğŸ“ ä»»åŠ¡2.2ï¼šè®­ç»ƒæ¨¡å‹")
print("ä½ çš„ä»£ç ï¼š")
# åœ¨è¿™é‡Œå†™ä»£ç ï¼š
# model.fit(?, ?)

# ä»»åŠ¡2.3ï¼šæŸ¥çœ‹æ¨¡å‹å‚æ•°
print("\nğŸ“ ä»»åŠ¡2.3ï¼šæŸ¥çœ‹æ¨¡å‹å‚æ•°")
print("çº¿æ€§å›å½’å…¬å¼ï¼šy = w*x + b")
print("ä½ çš„ä»£ç ï¼š")
# åœ¨è¿™é‡Œå†™ä»£ç ï¼š
# print(f"æ–œç‡(w): {model.coef_[0]:.4f}")
# print(f"æˆªè·(b): {model.intercept_:.4f}")

# ===== ç¬¬3å…³ï¼šæ¨¡å‹é¢„æµ‹ =====
print("\nğŸ¯ ç¬¬3å…³ï¼šæ¨¡å‹é¢„æµ‹")

# ä»»åŠ¡3.1ï¼šåœ¨æµ‹è¯•é›†ä¸Šé¢„æµ‹
print("\nğŸ“ ä»»åŠ¡3.1ï¼šåœ¨æµ‹è¯•é›†ä¸Šé¢„æµ‹")
print("ä½ çš„ä»£ç ï¼š")
# åœ¨è¿™é‡Œå†™ä»£ç ï¼š
# y_pred = 

# ä»»åŠ¡3.2ï¼šæ˜¾ç¤ºé¢„æµ‹ç»“æœ
print("\nğŸ“ ä»»åŠ¡3.2ï¼šæ˜¾ç¤ºé¢„æµ‹ç»“æœ")
print("ä½ çš„ä»£ç ï¼š")
# åœ¨è¿™é‡Œå†™ä»£ç ï¼š
# print(f"å‰5ä¸ªé¢„æµ‹ç»“æœ: {y_pred[:5]}")
# print(f"å‰5ä¸ªçœŸå®å€¼: {y_test[:5]}")

# ===== ç¬¬4å…³ï¼šæ¨¡å‹è¯„ä¼° =====
print("\nğŸ¯ ç¬¬4å…³ï¼šæ¨¡å‹è¯„ä¼°")

# ä»»åŠ¡4.1ï¼šè®¡ç®—å‡æ–¹è¯¯å·®(MSE)
print("\nğŸ“ ä»»åŠ¡4.1ï¼šè®¡ç®—å‡æ–¹è¯¯å·®(MSE)")
print("ä½ çš„ä»£ç ï¼š")
# åœ¨è¿™é‡Œå†™ä»£ç ï¼š
# mse = 
# print(f"å‡æ–¹è¯¯å·®: {mse:.4f}")

# ä»»åŠ¡4.2ï¼šè®¡ç®—RÂ²åˆ†æ•°
print("\nğŸ“ ä»»åŠ¡4.2ï¼šè®¡ç®—RÂ²åˆ†æ•°")
print("ä½ çš„ä»£ç ï¼š")
# åœ¨è¿™é‡Œå†™ä»£ç ï¼š
# r2 = 
# print(f"RÂ²åˆ†æ•°: {r2:.4f}")

# ä»»åŠ¡4.3ï¼šè§£é‡Šè¯„ä¼°ç»“æœ
print("\nğŸ“ ä»»åŠ¡4.3ï¼šè§£é‡Šè¯„ä¼°ç»“æœ")
print("è¯·å›ç­”ï¼š")
print("1. MSEè¶Šå°è¯´æ˜ä»€ä¹ˆï¼Ÿ")
print("2. RÂ²æ¥è¿‘1è¯´æ˜ä»€ä¹ˆï¼Ÿ")
print("3. è¿™ä¸ªæ¨¡å‹çš„æ•ˆæœå¦‚ä½•ï¼Ÿ")

# ä½ çš„å›ç­”ï¼š
# ç­”æ¡ˆ1ï¼š
# ç­”æ¡ˆ2ï¼š
# ç­”æ¡ˆ3ï¼š

# ===== ç¬¬5å…³ï¼šå¯è§†åŒ– =====
print("\nğŸ¯ ç¬¬5å…³ï¼šå¯è§†åŒ–")

# ä»»åŠ¡5.1ï¼šç»˜åˆ¶æ•£ç‚¹å›¾å’Œæ‹Ÿåˆçº¿
print("\nğŸ“ ä»»åŠ¡5.1ï¼šç»˜åˆ¶æ•£ç‚¹å›¾å’Œæ‹Ÿåˆçº¿")
print("ä½ çš„ä»£ç ï¼š")
# åœ¨è¿™é‡Œå†™ä»£ç ï¼š
# plt.figure(figsize=(10, 6))
# plt.scatter(X_test, y_test, alpha=0.6, label='çœŸå®å€¼')
# plt.plot(X_test, y_pred, 'r-', label='é¢„æµ‹å€¼')
# plt.xlabel('X')
# plt.ylabel('y')
# plt.title('çº¿æ€§å›å½’ç»“æœ')
# plt.legend()
# plt.show()

# ä»»åŠ¡5.2ï¼šç»˜åˆ¶æ®‹å·®å›¾
print("\nğŸ“ ä»»åŠ¡5.2ï¼šç»˜åˆ¶æ®‹å·®å›¾")
print("æ®‹å·® = çœŸå®å€¼ - é¢„æµ‹å€¼")
print("ä½ çš„ä»£ç ï¼š")
# åœ¨è¿™é‡Œå†™ä»£ç ï¼š
# residuals = y_test - y_pred
# plt.figure(figsize=(10, 6))
# plt.scatter(y_pred, residuals, alpha=0.6)
# plt.axhline(y=0, color='r', linestyle='--')
# plt.xlabel('é¢„æµ‹å€¼')
# plt.ylabel('æ®‹å·®')
# plt.title('æ®‹å·®å›¾')
# plt.show()

# ===== ç¬¬6å…³ï¼šæ–°æ•°æ®é¢„æµ‹ =====
print("\nğŸ¯ ç¬¬6å…³ï¼šæ–°æ•°æ®é¢„æµ‹")

# ä»»åŠ¡6.1ï¼šé¢„æµ‹æ–°æ•°æ®
print("\nğŸ“ ä»»åŠ¡6.1ï¼šé¢„æµ‹æ–°æ•°æ®")
print("å‡è®¾æœ‰æ–°çš„Xå€¼ï¼š[5, 10, 15]")
print("ä½ çš„ä»£ç ï¼š")
# åœ¨è¿™é‡Œå†™ä»£ç ï¼š
# new_X = np.array([[5], [10], [15]])
# new_pred = 
# print(f"æ–°æ•°æ®é¢„æµ‹ç»“æœ: {new_pred}")

# ä»»åŠ¡6.2ï¼šæ‰‹åŠ¨éªŒè¯
print("\nğŸ“ ä»»åŠ¡6.2ï¼šæ‰‹åŠ¨éªŒè¯")
print("ä½¿ç”¨å…¬å¼ y = w*x + b æ‰‹åŠ¨è®¡ç®—")
print("ä½ çš„ä»£ç ï¼š")
# åœ¨è¿™é‡Œå†™ä»£ç ï¼š
# w = model.coef_[0]
# b = model.intercept_
# manual_pred = w * new_X.ravel() + b
# print(f"æ‰‹åŠ¨è®¡ç®—ç»“æœ: {manual_pred}")

# ===== è‡ªæˆ‘æ£€æŸ¥ =====
print("\n" + "="*50)
print("ğŸ å®Œæˆç»ƒä¹ åï¼Œè¯·æ£€æŸ¥ï¼š")
print("1. ä½ èƒ½ç‹¬ç«‹å®Œæˆsklearnçš„åŸºæœ¬æ“ä½œå—ï¼Ÿ")
print("2. ä½ ç†è§£æ¨¡å‹è®­ç»ƒçš„æµç¨‹å—ï¼Ÿ")
print("3. ä½ çŸ¥é“å¦‚ä½•è¯„ä¼°æ¨¡å‹æ•ˆæœå—ï¼Ÿ")
print("4. ä½ èƒ½è§£é‡Šå„ä¸ªæŒ‡æ ‡çš„å«ä¹‰å—ï¼Ÿ")
print("\nğŸ’¡ è®°å½•ä¸‹ä¸ä¼šçš„æ“ä½œï¼Œæ˜å¤©é‡ç‚¹ç»ƒä¹ ï¼")

# ===== æç¤ºåŒºåŸŸ =====
print("\n" + "="*50)
print("ğŸ“– æç¤ºåŒºåŸŸ (å®åœ¨ä¸ä¼šæ—¶å†çœ‹)")
print("- æ•°æ®åˆ†å‰²ï¼štrain_test_split(X, y, test_size=0.3, random_state=42)")
print("- åˆ›å»ºæ¨¡å‹ï¼šLinearRegression()")
print("- è®­ç»ƒæ¨¡å‹ï¼šmodel.fit(X_train, y_train)")
print("- é¢„æµ‹ï¼šmodel.predict(X_test)")
print("- è¯„ä¼°ï¼šmean_squared_error(y_true, y_pred), r2_score(y_true, y_pred)")
print("- æ¨¡å‹å‚æ•°ï¼šmodel.coef_, model.intercept_")
print("="*50) 