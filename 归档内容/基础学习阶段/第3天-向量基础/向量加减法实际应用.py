#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
å‘é‡åŠ æ³•å’Œå‡æ³•çš„å®é™…åº”ç”¨
é‡ç‚¹ï¼šå¹³å‡ç”»åƒå’Œç”¨æˆ·ç‰¹å¾åˆ†æ
"""

import numpy as np
import matplotlib.pyplot as plt

# è®¾ç½®ä¸­æ–‡å­—ä½“
plt.rcParams['font.sans-serif'] = ['Arial Unicode MS', 'SimHei']
plt.rcParams['axes.unicode_minus'] = False

def vector_operations_real_world():
    print("ğŸ¯ å‘é‡åŠ æ³•å’Œå‡æ³•çš„å®é™…åº”ç”¨")
    print("=" * 50)
    
    # ç”¨æˆ·è´­ä¹°æ•°æ®ï¼š[3Cæ•°ç , æœè£…, é£Ÿå“, å›¾ä¹¦, è¿åŠ¨ç”¨å“]
    categories = ['3Cæ•°ç ', 'æœè£…', 'é£Ÿå“', 'å›¾ä¹¦', 'è¿åŠ¨ç”¨å“']
    
    # å¤šä¸ªç”¨æˆ·çš„è´­ä¹°æ¬¡æ•°
    ç”¨æˆ·æ•°æ® = np.array([
        [10, 2, 5, 8, 3],   # ç”¨æˆ·1ï¼šITç”·ï¼Œçˆ±ä¹°æ•°ç äº§å“å’Œä¹¦
        [12, 1, 4, 9, 2],   # ç”¨æˆ·2ï¼šç¨‹åºå‘˜ï¼Œç±»ä¼¼ç”¨æˆ·1
        [3, 15, 8, 2, 6],   # ç”¨æˆ·3ï¼šæ—¶å°šå¥³æ€§ï¼Œçˆ±ä¹°è¡£æœ
        [2, 18, 7, 1, 4],   # ç”¨æˆ·4ï¼šæ—¶å°šå¥³æ€§ï¼Œç±»ä¼¼ç”¨æˆ·3
        [5, 8, 12, 5, 15],  # ç”¨æˆ·5ï¼šè¿åŠ¨è¾¾äººï¼Œçˆ±å¥èº«å’Œç¾é£Ÿ
        [4, 6, 14, 3, 18],  # ç”¨æˆ·6ï¼šè¿åŠ¨è¾¾äººï¼Œç±»ä¼¼ç”¨æˆ·5
    ])
    
    ç”¨æˆ·å = ['ç”¨æˆ·1', 'ç”¨æˆ·2', 'ç”¨æˆ·3', 'ç”¨æˆ·4', 'ç”¨æˆ·5', 'ç”¨æˆ·6']
    
    print("ğŸ“Š ç”¨æˆ·è´­ä¹°æ•°æ®ï¼ˆæ¯æœˆè´­ä¹°æ¬¡æ•°ï¼‰:")
    print("ç”¨æˆ·\t", end="")
    for cat in categories:
        print(f"{cat}\t", end="")
    print()
    print("-" * 70)
    
    for i, name in enumerate(ç”¨æˆ·å):
        print(f"{name}\t", end="")
        for purchase in ç”¨æˆ·æ•°æ®[i]:
            print(f"{purchase}\t\t", end="")
        print()
    
    print(f"\n" + "="*50)
    print(f"ğŸ§® å‘é‡åŠ æ³•ï¼šè®¡ç®—å¹³å‡ç”»åƒ")
    print(f"="*50)
    
    # 1. å‘é‡åŠ æ³•ï¼šè®¡ç®—å¹³å‡ç”¨æˆ·ç”»åƒ
    æ€»å’Œå‘é‡ = np.sum(ç”¨æˆ·æ•°æ®, axis=0)
    å¹³å‡ç”»åƒ = æ€»å’Œå‘é‡ / len(ç”¨æˆ·æ•°æ®)
    
    print(f"\nğŸ“ˆ è®¡ç®—è¿‡ç¨‹:")
    print(f"æ‰€æœ‰ç”¨æˆ·æ€»å’Œ: {æ€»å’Œå‘é‡}")
    print(f"ç”¨æˆ·æ•°é‡: {len(ç”¨æˆ·æ•°æ®)}")
    print(f"å¹³å‡ç”¨æˆ·ç”»åƒ: {å¹³å‡ç”»åƒ}")
    print(f"å¹³å‡ç”¨æˆ·ç”»åƒï¼ˆå››èˆäº”å…¥ï¼‰: {np.round(å¹³å‡ç”»åƒ, 1)}")
    
    print(f"\nğŸ’¡ å¹³å‡ç”»åƒçš„å«ä¹‰:")
    for i, cat in enumerate(categories):
        print(f"- {cat}: å¹³å‡æ¯æœˆè´­ä¹° {å¹³å‡ç”»åƒ[i]:.1f} æ¬¡")
    
    print(f"\nğŸ¯ å¹³å‡ç”»åƒçš„å®é™…åº”ç”¨:")
    print(f"1. æ–°ç”¨æˆ·æ¨èï¼šæŒ‰å¹³å‡ç”»åƒæ¨èå•†å“")
    print(f"2. å¼‚å¸¸æ£€æµ‹ï¼šåç¦»å¹³å‡ç”»åƒå¤ªè¿œçš„ç”¨æˆ·")
    print(f"3. ç”¨æˆ·ç»†åˆ†ï¼šæ ¹æ®ä¸å¹³å‡ç”»åƒçš„å·®å¼‚åˆ†ç±»")
    print(f"4. åº“å­˜ç®¡ç†ï¼šæŒ‰å¹³å‡éœ€æ±‚å‡†å¤‡åº“å­˜")
    
    print(f"\n" + "="*50)
    print(f"â– å‘é‡å‡æ³•ï¼šä¸å¹³å‡ç”»åƒæ¯”è¾ƒ")
    print(f"="*50)
    
    # 2. å‘é‡å‡æ³•ï¼šåˆ†ææ¯ä¸ªç”¨æˆ·ä¸å¹³å‡ç”»åƒçš„å·®å¼‚
    print(f"\nğŸ“Š æ¯ä¸ªç”¨æˆ·ä¸å¹³å‡ç”»åƒçš„å·®å¼‚:")
    print(f"ç”¨æˆ·\tå·®å¼‚å‘é‡\t\t\t\tç”¨æˆ·ç‰¹å¾")
    print(f"-" * 80)
    
    ç”¨æˆ·ç‰¹å¾ = []
    for i, name in enumerate(ç”¨æˆ·å):
        å·®å¼‚å‘é‡ = ç”¨æˆ·æ•°æ®[i] - å¹³å‡ç”»åƒ
        
        print(f"{name}\t{np.round(å·®å¼‚å‘é‡, 1)}\t", end="")
        
        # åˆ†æç”¨æˆ·ç‰¹å¾
        max_diff_idx = np.argmax(np.abs(å·®å¼‚å‘é‡))
        if å·®å¼‚å‘é‡[max_diff_idx] > 2:
            ç‰¹å¾ = f"åçˆ±{categories[max_diff_idx]}"
        elif å·®å¼‚å‘é‡[max_diff_idx] < -2:
            ç‰¹å¾ = f"ä¸å–œæ¬¢{categories[max_diff_idx]}"
        else:
            ç‰¹å¾ = "æ¥è¿‘å¹³å‡ç”¨æˆ·"
        
        ç”¨æˆ·ç‰¹å¾.append(ç‰¹å¾)
        print(f"\t{ç‰¹å¾}")
    
    print(f"\nğŸ” å·®å¼‚åˆ†æçš„å®é™…åº”ç”¨:")
    
    # å…·ä½“æ¡ˆä¾‹åˆ†æ
    print(f"\nğŸ“ˆ å…·ä½“åˆ†æ:")
    
    # åˆ†æç”¨æˆ·1
    ç”¨æˆ·1å·®å¼‚ = ç”¨æˆ·æ•°æ®[0] - å¹³å‡ç”»åƒ
    print(f"\nğŸ‘¤ ç”¨æˆ·1å·®å¼‚åˆ†æ:")
    print(f"åŸå§‹æ•°æ®: {ç”¨æˆ·æ•°æ®[0]}")
    print(f"å¹³å‡ç”»åƒ: {np.round(å¹³å‡ç”»åƒ, 1)}")
    print(f"å·®å¼‚å‘é‡: {np.round(ç”¨æˆ·1å·®å¼‚, 1)}")
    
    for i, cat in enumerate(categories):
        diff = ç”¨æˆ·1å·®å¼‚[i]
        if diff > 2:
            print(f"- {cat}: +{diff:.1f} â†’ æ¯”å¹³å‡ç”¨æˆ·æ›´çˆ±ä¹°")
        elif diff < -2:
            print(f"- {cat}: {diff:.1f} â†’ æ¯”å¹³å‡ç”¨æˆ·æ›´å°‘ä¹°")
    
    print(f"\nğŸ¯ åŸºäºå·®å¼‚çš„æ¨èç­–ç•¥:")
    print(f"1. æ­£å·®å¼‚å¤§çš„ç±»åˆ« â†’ æ¨èæ›´å¤šæ­¤ç±»å•†å“")
    print(f"2. è´Ÿå·®å¼‚å¤§çš„ç±»åˆ« â†’ é¿å…æ¨èæ­¤ç±»å•†å“")
    print(f"3. æ¥è¿‘0çš„ç±»åˆ« â†’ æŒ‰å¹³å‡æ¨èç­–ç•¥")
    
    # å®é™…ä¸šåŠ¡åº”ç”¨
    print(f"\n" + "="*50)
    print(f"ğŸš€ å®é™…ä¸šåŠ¡åº”ç”¨åœºæ™¯")
    print(f"="*50)
    
    print(f"\nğŸ“¦ 1. ç”µå•†å¹³å°åº”ç”¨:")
    print(f"å‘é‡åŠ æ³•: è®¡ç®—å•†å“å“ç±»çš„å¹³å‡è´­ä¹°é‡")
    print(f"å‘é‡å‡æ³•: è¯†åˆ«ç”¨æˆ·åå¥½ä¸ä¸€èˆ¬ç”¨æˆ·çš„å·®å¼‚")
    print(f"åº”ç”¨: ä¸ªæ€§åŒ–æ¨èã€åº“å­˜ç®¡ç†ã€ç”¨æˆ·ç”»åƒ")
    
    print(f"\nğŸµ 2. éŸ³ä¹å¹³å°åº”ç”¨:")
    print(f"å‘é‡åŠ æ³•: è®¡ç®—å„éŸ³ä¹ç±»å‹çš„å¹³å‡æ”¶å¬æ—¶é•¿")
    print(f"å‘é‡å‡æ³•: è¯†åˆ«ç”¨æˆ·éŸ³ä¹åå¥½çš„ç‹¬ç‰¹æ€§")
    print(f"åº”ç”¨: ä¸ªæ€§åŒ–æ­Œå•ã€æ–°äººæ¨èã€éŸ³ä¹å‘ç°")
    
    print(f"\nğŸ¬ 3. è§†é¢‘å¹³å°åº”ç”¨:")
    print(f"å‘é‡åŠ æ³•: è®¡ç®—å„ç±»è§†é¢‘çš„å¹³å‡è§‚çœ‹æ—¶é•¿")
    print(f"å‘é‡å‡æ³•: è¯†åˆ«ç”¨æˆ·è§‚çœ‹ä¹ æƒ¯çš„ç‰¹æ®Šæ€§")
    print(f"åº”ç”¨: ä¸ªæ€§åŒ–æ¨èã€å†…å®¹åˆ¶ä½œæŒ‡å¯¼")
    
    print(f"\nğŸ’¡ å…³é”®ç†è§£:")
    print(f"- å‘é‡åŠ æ³• = æ±‚å¹³å‡ã€æ‰¾åŸºå‡†ã€å»ºç«‹æ ‡å‡†ç”»åƒ")
    print(f"- å‘é‡å‡æ³• = æ‰¾å·®å¼‚ã€è¯†åˆ«ç‰¹å¾ã€ä¸ªæ€§åŒ–åˆ†æ")
    print(f"- å¹³å‡ç”»åƒ = ä¸šåŠ¡åŸºå‡†çº¿ï¼Œç”¨äºæ¯”è¾ƒå’Œæ¨è")

def visualize_user_analysis():
    """å¯è§†åŒ–ç”¨æˆ·ç”»åƒåˆ†æ"""
    print(f"\nğŸ“Š ç”Ÿæˆç”¨æˆ·ç”»åƒå¯è§†åŒ–...")
    
    # ç¤ºä¾‹æ•°æ®
    categories = ['3Cæ•°ç ', 'æœè£…', 'é£Ÿå“', 'å›¾ä¹¦', 'è¿åŠ¨ç”¨å“']
    ç”¨æˆ·æ•°æ® = np.array([
        [10, 2, 5, 8, 3],   # ç”¨æˆ·1
        [3, 15, 8, 2, 6],   # ç”¨æˆ·3
        [5, 8, 12, 5, 15],  # ç”¨æˆ·5
    ])
    
    ç”¨æˆ·å = ['ç”¨æˆ·1(ITç”·)', 'ç”¨æˆ·3(æ—¶å°šå¥³)', 'ç”¨æˆ·5(è¿åŠ¨è¾¾äºº)']
    å¹³å‡ç”»åƒ = np.mean(ç”¨æˆ·æ•°æ®, axis=0)
    
    # åˆ›å»ºé›·è¾¾å›¾
    angles = np.linspace(0, 2 * np.pi, len(categories), endpoint=False)
    angles = np.concatenate((angles, [angles[0]]))  # é—­åˆå›¾å½¢
    
    fig, ax = plt.subplots(figsize=(10, 8), subplot_kw=dict(projection='polar'))
    
    # ç»˜åˆ¶å¹³å‡ç”»åƒ
    å¹³å‡æ•°æ® = np.concatenate((å¹³å‡ç”»åƒ, [å¹³å‡ç”»åƒ[0]]))
    ax.plot(angles, å¹³å‡æ•°æ®, 'o-', linewidth=2, label='å¹³å‡ç”»åƒ', color='gray')
    ax.fill(angles, å¹³å‡æ•°æ®, alpha=0.25, color='gray')
    
    # ç»˜åˆ¶å„ç”¨æˆ·
    colors = ['red', 'blue', 'green']
    for i, (name, data) in enumerate(zip(ç”¨æˆ·å, ç”¨æˆ·æ•°æ®)):
        ç”¨æˆ·æ•°æ®_é—­åˆ = np.concatenate((data, [data[0]]))
        ax.plot(angles, ç”¨æˆ·æ•°æ®_é—­åˆ, 'o-', linewidth=2, label=name, color=colors[i])
        ax.fill(angles, ç”¨æˆ·æ•°æ®_é—­åˆ, alpha=0.25, color=colors[i])
    
    # è®¾ç½®æ ‡ç­¾
    ax.set_xticks(angles[:-1])
    ax.set_xticklabels(categories)
    ax.set_ylim(0, 20)
    ax.set_title('ç”¨æˆ·è´­ä¹°åå¥½é›·è¾¾å›¾', size=16, y=1.1)
    ax.legend(loc='upper right', bbox_to_anchor=(1.3, 1.0))
    
    plt.tight_layout()
    plt.show()
    
    print(f"å›¾è¡¨è¯´æ˜:")
    print(f"- ç°è‰²åŒºåŸŸï¼šå¹³å‡ç”¨æˆ·ç”»åƒ")
    print(f"- å½©è‰²åŒºåŸŸï¼šå…·ä½“ç”¨æˆ·åå¥½")
    print(f"- åç¦»ç°è‰²åŒºåŸŸè¶Šè¿œ = ä¸ªæ€§åŒ–ç¨‹åº¦è¶Šé«˜")

if __name__ == "__main__":
    vector_operations_real_world()
    visualize_user_analysis() 